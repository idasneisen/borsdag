<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Børsdagspartay – Leaderboard</title>

  <style>
    body{
      margin:0;
      font-family: system-ui, -apple-system, sans-serif;
      background: radial-gradient(circle at top left,#5b2cff,#001b3f);
      color:white;
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:center;
      padding:30px;
    }

    .container{
      width:900px;
      max-width:100%;
    }

    h1{
      font-size:48px;
      margin-bottom:20px;
    }

    .board{
      background:rgba(0,0,0,0.3);
      padding:20px;
      border-radius:20px;
    }

    .row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:15px 20px;
      margin-bottom:12px;
      border-radius:15px;
      font-size:22px;
      font-weight:600;
      transition:0.4s;
      background:rgba(255,255,255,0.08);
    }

    .top1{background:rgba(255,215,0,0.25);}
    .top2{background:rgba(192,192,192,0.25);}
    .top3{background:rgba(205,127,50,0.25);}

    .rank{
      font-weight:900;
      margin-right:15px;
    }

    .left{
      display:flex;
      align-items:center;
    }

    .score{
      font-size:26px;
      font-weight:900;
    }

    .status{
      margin-top:15px;
      opacity:0.7;
    }

    .error{
      margin-top:15px;
      padding:15px;
      border-radius:10px;
      background:#ff2d2d33;
      display:none;
      white-space:pre-line;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>Børsdagspartay</h1>

    <div class="board" id="board"></div>

    <div class="status" id="status">Laster...</div>
    <div class="error" id="error"></div>
  </div>

  <script>
    // === VIKTIG ===
    // Hvis fanen nederst i Google Sheet heter noe annet enn "Poeng",
    // bytt ut Poeng i denne linjen.
    const DATA_URL = "https://opensheet.elk.sh/1XmtpS4_F4vqQtcUWcUVOuEEdp9l6qrfKNDnHCD-oHSQ/Poeng";

    const REFRESH_MS = 10000;

    const board = document.getElementById("board");
    const statusEl = document.getElementById("status");
    const errorEl = document.getElementById("error");

    async function load(){
      errorEl.style.display = "none";
      try{
        const res = await fetch(DATA_URL + "?t=" + Date.now());
        if(!res.ok) throw new Error("Kunne ikke hente data");

        const json = await res.json();

        const data = json
          .filter(r => r.Lag)
          .map(r => ({
            name: r.Lag,
            score: Number(r.Poeng) || 0
          }))
          .sort((a,b) => b.score - a.score);

        board.innerHTML = "";

        data.forEach((team, index) => {
          const row = document.createElement("div");
          row.className = "row";
          if(index === 0) row.classList.add("top1");
          if(index === 1) row.classList.add("top2");
          if(index === 2) row.classList.add("top3");

          row.innerHTML = `
            <div class="left">
              <div class="rank">${index+1}</div>
              <div>${team.name}</div>
            </div>
            <div class="score">${team.score}</div>
          `;

          board.appendChild(row);
        });

        statusEl.textContent = "Oppdateres automatisk";

      }catch(e){
        errorEl.style.display = "block";
        errorEl.textContent =
          "Feil ved lasting.\n\n" +
          "Sjekk:\n" +
          "• At arknavnet er riktig (nå: Poeng)\n" +
          "• At kolonnene heter: Lag og Poeng";
        statusEl.textContent = "Kunne ikke oppdatere.";
      }
    }

    load();
    setInterval(load, REFRESH_MS);
  </script>
</body>
</html>
